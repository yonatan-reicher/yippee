module Yippee exposing (Yippee, Msg, view, update)

import Model exposing (Resources, Vec)
import Html.Styled exposing (img)
import Html.Styled.Attributes exposing (src)
import Css exposing ()


type alias Yippee a =
    { a
    | pos : Vec
    , targetPos : Vec
    , focusPos : Vec
    , flipped : Bool
    , happiness : Float
    , level : Int
    , jump : Float
    }


view : Yippee Resources -> Html Msg
view { pos, flipped, jump, happiness } =
    let
        xScale =
            if flipped then
                -1

            else
                1


        transformTransitionTime =
            if jump == 0 then
                200

            else
                0
    in
    img
        [ src resources.yippeeUrl
        , noDrag
        , onClick YippeeClicked
        , cssUnset
            [ Css.width (px (100 + happiness * 7))
            , screenPosition { x = pos.x, y = pos.y + 200 * (1 - (2 * jump - 1) ^ 2 |> Basics.max 0) }
            , opacity (num 90)
            , transition
                [ Css.Transitions.transform3 transformTransitionTime 0 easeInOut
                , Css.Transitions.width3 2000 0 easeInOut
                ]
            , transforms
                [ centerX
                , scaleX xScale
                , rotate (deg <| -jump * 360)
                ]
            ]
        ]
        []

